{"config":{"lang":["en","pt"],"separator":"[\\s\\-,:!=\\[\\]()\"/]+|(?!\\b)(?=[A-Z][a-z])|\\.(?!\\d)|&[lg]t;","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Crazyarena Repository","text":"<p>This repository makes use of the CrazyS and Crazyswarm packages as well as the cfclient to provide a starting point for running simulations and real experiments using one or more Crazyflies. The crazyarena repository makes use of docker to simplify the installation procedure.</p>"},{"location":"#prerequesites","title":"Prerequesites","text":"<p>Make sure you have docker properly installed before continuing, official instalation instructions are available here. It is also recommended that you visit the documentation for CrazyS and Crazyswarm.</p> <p>Warning</p> <p>This repository has only been tested on ubuntu 18.04. Windows is not supported and virtual machines are discouraged.</p>"},{"location":"common_errors/","title":"Common errors","text":"<p>If you encouter the issue ModuleNotFoundError: No module named 'crazyswarm' while running a real experiment using the crazyswarm package, make sure you have sourced the setup file with the missing module path.</p> <pre><code>cd ~/crazyswarm/ros_ws\nsource devel/setup.bash\n</code></pre> <p>If you get a USB permissions error while using cfclient run these commands as root to give the crazyuser the necessary permissions. More information here.</p> <pre><code>apt-get install udev\nmkdir -p /etc/udev/rules.d\n/lib/systemd/systemd-udevd \u2014daemon\ngroupadd plugdev\nusermod -a -G plugdev crazyuser\ncat &lt;&lt;EOF | sudo tee /etc/udev/rules.d/99-bitcraze.rules &gt; /dev/null\n    # Crazyradio (normal operation)\n    SUBSYSTEM==\"usb\", ATTRS{idVendor}==\"1915\", ATTRS{idProduct}==\"7777\", MODE=\"0664\", GROUP=\"plugdev\"\n    # Bootloader\n    SUBSYSTEM==\"usb\", ATTRS{idVendor}==\"1915\", ATTRS{idProduct}==\"0101\", MODE=\"0664\", GROUP=\"plugdev\"\n    # Crazyflie (over USB)\n    SUBSYSTEM==\"usb\", ATTRS{idVendor}==\"0483\", ATTRS{idProduct}==\"5740\", MODE=\"0664\", GROUP=\"plugdev\"\n    EOF\nudevadm control --reload-rules\nudevadm trigger\n</code></pre>"},{"location":"docker/","title":"Dealing with docker containers","text":"<p>If for some reason you need to stop or start the container the following commands might be helpful.</p> <pre><code>docker stop crazyarena\ndocker start crazyarena\n</code></pre> <p>If you need privileged access to the container you can open a new shell with the root user:</p> <pre><code>docker exec -it -u root crazyarena bash\n</code></pre>"},{"location":"install_guide/","title":"Installation Instructions","text":"<p>Start by cloning this repository.</p> <pre><code>git clone https://github.com/cybaer-nova/crazyarena\ncd crazyarena\n</code></pre> <p>A script is provided to install the crazyarena. This script is responsible for building the docker image from the Dockerfile as well as creating the container from the built image. Additionally, it is possible to include the nvidia drivers in the image if you have an nvidia gpu. To do this select the cuda image, otherwise use the base image. To use the script, the flags <code>-b</code> and <code>-c</code> can be used to build the image and create the container respectively.</p> <p>Note</p> <p>When using the cuda image, it is necessary to install the NVIDIA Container Toolkit on the host machine in addition to the specific graphics drivers for your gpu. The NVIDIA Container Toolkit allows users to build and run GPU accelerated containers using container engines such as Docker.</p> <p>Note</p> <p>If you have a CPU with more than 4 cores you can find the line with the command <code>catkin build -j2</code> and change the number 2 for ( - 2). If you use all the cores to compile the workspace it can lead to a crash. <pre><code>./run_crazyarena.bash -b &lt;base,cuda&gt; -c &lt;base,cuda&gt;\n</code></pre> <p>After the installation is complete it is possible to start the crazyarena container and open a shell inside. </p> <pre><code>docker start crazyarena\ndocker exec -it crazyarena bash\n</code></pre> <p>Moreover both the CrazyS and Crazyswarm workspaces are available outside the container using docker volumes making it easy to edit files inside them. These volumes are mapped to the crazyarena repository folder.</p> <p>The repository also includes a convenience script to remove the container, image and volumes from docker. </p> <p>Note</p> <p>If you are using this script as middle step to fix your installation don't forget to delete the catkin_ws and crazyswarm folders before installing again.</p> <pre><code>./rm_crazyarena.bash\n</code></pre> <p>Warning</p> <p>Make sure you only make changes to the contents of the volumes (catkin_ws and crazyswarm folders) while the container is running, otherwise the changes are not persistent and you may loose them.</p>"},{"location":"repo_structure/","title":"Repository Structure","text":"<p>This repository consists of two Dockerfiles along with two scripts:</p> <ul> <li>Dockerfile-base-cuda: A dockerfile which installs the nvidia drivers on top of the base image;</li> <li>Dockerfile: A dockerfile which installs the CrazyS, Crazyswarm and cfclient packages;</li> <li>run_crazyarena.bash: A bash script to create the crazyarena docker container as well as to build the images needed.</li> <li>rm_crazyarena.bash: A bash script to remove the installation of the crazyarena docker container as well as to remove the images and volumes created.</li> </ul>"},{"location":"examples/hello_world/crazys/","title":"CrazyS","text":"<p>This simulation uses the CrazyS hovering example code to demonstrate how the simulation process using the CrazyS package works. To begin with let's create a cpp ros package:</p> <pre><code>cd /home/crazyuser/catkin_ws/src/\ncatkin_create_pkg hello_world\n</code></pre> <p>Now enter the package and create the script where the hovering example code will go:</p> <pre><code>cd hello_world\nmkdir src launch\ncd src\ntouch hovering_example.cpp\n</code></pre> <p>Following that, create the launch file that runs the simulation</p> <pre><code>cd ../launch\ntouch hovering_example.launch\n</code></pre> <p>After creating the package and setting up the file structure open the files in a text editor.</p>"},{"location":"examples/hello_world/crazys/#hovering_examplecpp","title":"hovering_example.cpp","text":"<p>Copy the contents of the catkin_ws/src/CrazyS/rotors_gazebo/src/nodes/hovering_example.cpp file to this file as no modifications are needed for this example.</p>"},{"location":"examples/hello_world/crazys/#packagexml","title":"package.xml","text":"<p>Fill in the package.xml file as shown to include all the libraries needed. The contents of this file are based on the hovering example package provided by the CrazyS package.</p> <pre><code>&lt;package&gt;\n  &lt;name&gt;rotors_gazebo&lt;/name&gt;\n  &lt;version&gt;7.0.1&lt;/version&gt;\n  &lt;description&gt;The rotors_gazebo package&lt;/description&gt;\n\n  &lt;maintainer email=\"giuseppe.silano@fel.cvut.cz\"&gt;Giuseppe Silano&lt;/maintainer&gt;\n  &lt;maintainer email=\"luigi.iannelli@unisannio.it\"&gt;Luigi Iannelli&lt;/maintainer&gt;\n\n  &lt;author&gt;Giuseppe Silano&lt;/author&gt;\n  &lt;author&gt;Emanuele Aucone&lt;/author&gt;\n  &lt;author&gt;Benjamin Rodriguez&lt;/author&gt;\n  &lt;author&gt;Luigi Iannelli&lt;/author&gt;\n  &lt;author&gt;Ria Sonecha&lt;/author&gt;\n  &lt;author&gt;Daniele Morra&lt;/author&gt;\n\n  &lt;license&gt;ASL 2.0&lt;/license&gt;\n\n  &lt;url type=\"website\"&gt;https://github.com/gsilano/CrazyS&lt;/url&gt;\n  &lt;url type=\"bugtracker\"&gt;https://github.com/gsilano/CrazyS/issues&lt;/url&gt;\n\n  &lt;buildtool_depend&gt;catkin&lt;/buildtool_depend&gt;\n\n  &lt;!-- Dependencies needed to compile this package. --&gt;\n  &lt;build_depend&gt;gazebo_plugins&lt;/build_depend&gt;\n  &lt;build_depend&gt;rotors_gazebo_plugins&lt;/build_depend&gt;\n  &lt;build_depend&gt;mav_msgs&lt;/build_depend&gt;\n  &lt;build_depend&gt;nav_msgs&lt;/build_depend&gt;\n  &lt;build_depend&gt;gazebo_msgs&lt;/build_depend&gt;\n  &lt;build_depend&gt;geometry_msgs&lt;/build_depend&gt;\n  &lt;build_depend&gt;roscpp&lt;/build_depend&gt;\n  &lt;build_depend&gt;sensor_msgs&lt;/build_depend&gt;\n  &lt;build_depend&gt;cmake_modules&lt;/build_depend&gt;\n  &lt;build_depend&gt;tf&lt;/build_depend&gt;\n  &lt;build_depend&gt;tf2&lt;/build_depend&gt;\n\n  &lt;!-- Dependencies needed after this package is compiled. --&gt;\n  &lt;run_depend&gt;gazebo_plugins&lt;/run_depend&gt;\n  &lt;run_depend&gt;dynamic_reconfigure&lt;/run_depend&gt;\n  &lt;run_depend&gt;rotors_gazebo_plugins&lt;/run_depend&gt;\n  &lt;run_depend&gt;mav_msgs&lt;/run_depend&gt;\n  &lt;run_depend&gt;nav_msgs&lt;/run_depend&gt;\n  &lt;run_depend&gt;gazebo_msgs&lt;/run_depend&gt;\n  &lt;run_depend&gt;geometry_msgs&lt;/run_depend&gt;\n  &lt;run_depend&gt;roscpp&lt;/run_depend&gt;\n  &lt;run_depend&gt;sensor_msgs&lt;/run_depend&gt;\n  &lt;run_depend&gt;tf&lt;/run_depend&gt;\n  &lt;run_depend&gt;tf2&lt;/run_depend&gt;\n\n&lt;/package&gt;\n</code></pre>"},{"location":"examples/hello_world/crazys/#cmakeliststxt","title":"CMakeLists.txt","text":"<p>Finally, fill in the CMakeLists.txt file as shown to include all the libraries needed:</p> <pre><code>cmake_minimum_required(VERSION 3.0.2)\nproject(hello_world)\n\nadd_definitions(-std=c++11)\n\nfind_package(catkin REQUIRED COMPONENTS\n  mav_msgs\n  roscpp\n  cmake_modules\n)\n\nfind_package(\n  Eigen3 REQUIRED\n)\n\ncatkin_package(\n  INCLUDE_DIRS ${Eigen3_INCLUDE_DIRS}\n  LIBRARIES spline_trajectory_generator\n  CATKIN_DEPENDS geometry_msgs mav_msgs nav_msgs roscpp sensor_msgs gazebo_msgs\n  DEPENDS Eigen3\n)\n\ninclude_directories(\n  ${catkin_INCLUDE_DIRS}\n  ${Eigen3_INCLUDE_DIRS}\n)\n\nadd_executable(hovering_example src/hovering_example.cpp)\ntarget_link_libraries(hovering_example ${catkin_LIBRARIES})\nadd_dependencies(hovering_example ${catkin_EXPORTED_TARGETS})\n\n\nforeach(dir launch models resource worlds)\n   install(DIRECTORY ${dir}/\n      DESTINATION ${CATKIN_PACKAGE_SHARE_DESTINATION}/${dir})\nendforeach(dir)\n\ninstall(TARGETS hovering_example\n  ARCHIVE DESTINATION ${CATKIN_PACKAGE_LIB_DESTINATION}\n  LIBRARY DESTINATION ${CATKIN_PACKAGE_LIB_DESTINATION}\n  RUNTIME DESTINATION ${CATKIN_PACKAGE_BIN_DESTINATION}\n)\n\ninstall(\n  DIRECTORY include/${PROJECT_NAME}/\n  DESTINATION ${CATKIN_PACKAGE_INCLUDE_DESTINATION}\n  FILES_MATCHING PATTERN \"*.h\"\n)\n</code></pre>"},{"location":"examples/hello_world/crazys/#running-the-simulation","title":"Running the simulation","text":"<p>Before running the simulation the package must be build. To do this navigate to the catkin_ws folder and run the command <code>catkin build</code>. After this the new built workspace must be sourced. To do this run the command <code>source devel/setup.bash</code>. Now the simulation can be launched by running <code>roslaunch hello_world hovering_example.launch</code>. You should see the gazebo gui launch and an instance of the crazyflie vehicle spawn. The simulation only performs a simple takeoff and hover.</p> <p> </p> CrazyS hello_world demo"},{"location":"examples/hello_world/crazyswarm/","title":"Crazyswarm","text":"<p>This simulation makes use of the Crazyswarm package to run a simulation where a single crazyflie takes-off, hovers and lands. First we need to create a package. Navigate to the crazyswarm workspace and run the following commands to create the files needed.</p> <pre><code>cd crazyswarm/ros_ws/src\nmkdir -p hello_world/scripts\ncd hello_world\nmkdir launch\ntouch package.xml\ntouch CMakeLists.txt\ncd scripts\ntouch hello_world.py\ncd ../launch\ntouch crazyflies.yaml\n</code></pre> <p>Now open this folder and edit the files created according to the following instructions. </p>"},{"location":"examples/hello_world/crazyswarm/#packagexml","title":"package.xml","text":"<p>Copy this into the package.xml file to include the needed libraries.</p> <pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;package format=\"2\"&gt;\n  &lt;name&gt;hello_world&lt;/name&gt;\n  &lt;version&gt;0.0.0&lt;/version&gt;\n  &lt;description&gt;The hello_world package&lt;/description&gt;\n\n  &lt;!-- One maintainer tag required, multiple allowed, one person per tag --&gt;\n  &lt;!-- Example:  --&gt;\n  &lt;!-- &lt;maintainer email=\"jane.doe@example.com\"&gt;Jane Doe&lt;/maintainer&gt; --&gt;\n  &lt;maintainer email=\"crazyuser@todo.todo\"&gt;crazyuser&lt;/maintainer&gt;\n\n  &lt;!-- One license tag required, multiple allowed, one license per tag --&gt;\n  &lt;!-- Commonly used license strings: --&gt;\n  &lt;!--   BSD, MIT, Boost Software License, GPLv2, GPLv3, LGPLv2.1, LGPLv3 --&gt;\n  &lt;license&gt;TODO&lt;/license&gt;\n\n  &lt;build_depend&gt;message_generation&lt;/build_depend&gt;\n  &lt;exec_depend&gt;message_runtime&lt;/exec_depend&gt;\n  &lt;buildtool_depend&gt;catkin&lt;/buildtool_depend&gt;\n  &lt;build_depend&gt;rospy&lt;/build_depend&gt;\n  &lt;build_depend&gt;std_msgs&lt;/build_depend&gt;\n  &lt;build_depend&gt;geometry_msgs&lt;/build_depend&gt;\n  &lt;build_depend&gt;rosgraph_msgs&lt;/build_depend&gt;\n  &lt;build_depend&gt;vizualization_msgs&lt;/build_depend&gt;\n  &lt;build_depend&gt;crazyswarm&lt;/build_depend&gt;\n  &lt;build_export_depend&gt;rospy&lt;/build_export_depend&gt;\n  &lt;build_export_depend&gt;std_msgs&lt;/build_export_depend&gt;\n  &lt;exec_depend&gt;rospy&lt;/exec_depend&gt;\n  &lt;exec_depend&gt;std_msgs&lt;/exec_depend&gt;\n  &lt;exec_depend&gt;geometry_msgs&lt;/exec_depend&gt;\n  &lt;exec_depend&gt;rosgraph_msgs&lt;/exec_depend&gt;\n  &lt;exec_depend&gt;vizualization_msgs&lt;/exec_depend&gt;\n  &lt;exec_depend&gt;crazyswarm&lt;/exec_depend&gt;\n\n&lt;/package&gt;\n</code></pre>"},{"location":"examples/hello_world/crazyswarm/#cmakeliststxt","title":"CMakeLists.txt","text":"<p>Copy this into the CMakeLists.txt file to include the needed libraries.</p> <pre><code>cmake_minimum_required(VERSION 3.0.2)\nproject(hello_world)\n\nfind_package(catkin REQUIRED COMPONENTS\n  rospy\n  std_msgs\n  geometry_msgs\n  rosgraph_msgs\n  crazyswarm\n)\n\ncatkin_package(\n)\n\ninclude_directories(\n  ${catkin_INCLUDE_DIRS}\n)\n</code></pre>"},{"location":"examples/hello_world/crazyswarm/#hello_worldpy","title":"hello_world.py","text":"<p>This file contains the actual script that sends the take-off, hover and land commands to the crazyfly. Copy the following into the file.</p> <pre><code>\"\"\"Takeoff-hover-land for one CF. Useful to validate hardware config.\"\"\"\nimport sys\nfrom os.path import dirname, abspath\nsys.path.insert(0, dirname(dirname(dirname(abspath(__file__))))+\"/crazyswarm/scripts\")\nprint(dirname(dirname(dirname(abspath(__file__))))+\"/crazyswarm/scripts\")\nfrom pycrazyswarm import Crazyswarm\n\n\nTAKEOFF_DURATION = 2.5\nHOVER_DURATION = 5.0\n\n\ndef main():\n    crazyflies_yaml = dirname(dirname(abspath(__file__)))+\"/launch/crazyflies.yaml\"\n    swarm = Crazyswarm(crazyflies_yaml=crazyflies_yaml)\n    timeHelper = swarm.timeHelper\n    cf = swarm.allcfs.crazyflies[0]\n\n    cf.takeoff(targetHeight=1.0, duration=TAKEOFF_DURATION)\n    timeHelper.sleep(TAKEOFF_DURATION + HOVER_DURATION)\n    cf.land(targetHeight=0.04, duration=2.5)\n    timeHelper.sleep(TAKEOFF_DURATION)\n\n\nif __name__ == \"__main__\":\n    main()\n</code></pre>"},{"location":"examples/hello_world/crazyswarm/#crazyfliesyaml","title":"crazyflies.yaml","text":"<p>This file contains your vehicle definitions. To learn how to use this file check the Crazyswarm documentation. For now a simulation example is given.</p> <pre><code>crazyflies:\n- channel: 100\n  id: 1\n  initialPosition: [1.5, 1.5, 0.0]\n  type: medium\n</code></pre> <p>Now that all the files have been edited the package can be built. This only needs to be done once to create the package as python scripts do not need to be compiled. Navigate to the crazyswarm/ros_ws folder and run the command <code>catkin_make</code> to build the workspace. After this the newly built workspace must be sourced. To do this run the command <code>source devel/setup.bash</code>.</p>"},{"location":"examples/hello_world/crazyswarm/#simulation","title":"Simulation","text":"<p>To run the simulation execute the following commands.</p> <pre><code>cd ~/crazyswarm/ros_ws/src/hello_world/scripts\nchmod +x hello_world.py\npython3 hello_world.py --sim\n</code></pre> <p> </p> Crazyswarm hello_world simulation demo"},{"location":"examples/hello_world/crazyswarm/#real-experiment","title":"Real Experiment","text":"<p>Before running the real experiment make sure you have properly configured the id and channel of your crazyflies in the crazyflies.yaml file. Copy the launch file used to launch the crazyswarm server.</p> <pre><code>cp ~/crazyswarm/ros_ws/src/crazyswarm/launch/hover_swarm.launch ~/crazyswarm/ros_ws/src/hello_world/launch/run.launch\n</code></pre> <p>Now recompile and resource the workspace.</p> <pre><code>cd ~/crazyswarm/ros_ws\ncatkin_make\nsource devel/setup.bash\n</code></pre> <p>Finally to run the experiment execute the following commands.</p> <pre><code>roslaunch hello_world run.launch\ncd ~/crazyswarm/ros_ws/src/hello_world/scripts\npython3 hello_world.py\n</code></pre>"}]}